select * from alumnos;
select nombre, apellidos from alumnos;
select CONCAT(nombre," ",apellidos) as nombre_completo from alumnos;
select max(nota) from alumnos;
select min(nota) from alumnos;
select avg(nota) from alumnos;
select min(nota), max(nota), avg(nota) from alumnos;

select distinct pais from alumnos;

-- filtro
select * from alumnos
where pais = 'Peru';

-- filtro con operacion
select * from alumnos
where nota > 10;

-- filtro con condiciones
select count(*) from alumnos
where nota > 10
and pais = 'Peru';

select count(*) as total from alumnos
where nota between 11 and 15;

select * from alumnos
where nota between 11 and 15;

select * from alumnos
where nombre like 'A%';

select * from alumnos
where nombre like '%ana%';

-- expresiones regulares
select * from alumnos
where nombre regexp '^A'

-- filtro con like
select count(*) from alumnos
where email like '%@gmail.com';

select pais, count(*) as total from alumnos
group by pais;

select pais, count(*) as total from alumnos
group by pais
order by count(*) desc;

-- agrupacion por pais
select pais, count(*) as total from alumnos
group by pais
having count(*) > 10
order by pais desc;

-- agrupacion con filtro
select pais, count(id) as total from alumnos
group by pais
having count(*) > 10
order by pais desc;

-- RETO
-- MOSTRAR EL PROMEDIO DE NOTA DE ALUMNOS POR PAIS ORDENADO DE MAYOR A MENOR

select pais, avg(nota) as promedio from alumnos
group by pais
order by promedio desc;

select pais, count(*) as total from alumnos
group by pais
having total > 10;

select pais, avg(nota) as promedio from alumnos
group by pais
having count(*) > 10
order by promedio desc;

-- mostrar el numero de alumnos por pais que aprobaron el curso considerando que la nota aprobatoria es mayor a 13

select pais, count(*) as total from alumnos
where nota > 13
group by pais;


-- mostrar los alumnos de Peru cuya nota es mayor al promedio de la nota total del pais

select * from alumnos where pais ='Peru'
select avg(nota) from alumnos where pais = 'Peru'

-- subconsultas
select * from alumnos where pais = 'Peru'
and nota > (select avg(nota) from alumnos where pais = 'Peru');

select nombre, nota, (select avg(nota) from alumnos where pais = 'Peru') as promedio,
(nota - (select avg(nota) from alumnos where pais = 'Peru')) as diferencia from alumnos
where pais = 'Peru'
and nota > (select avg(nota) from alumnos where pais = 'Peru');

select nombre, nota, (select avg(nota) from alumnos where pais = 'Peru') as promedio,
(nota - promedio) as diferencia from alumnos
where pais = 'Peru'
and nota > promedio;

select pais, count(id) as total
from alumnos
where nota > (select avg(alu_avg.nota) from alumnos alu_avg where alu_avg.pais=pais)
group by pais
order by total desc;

-- insert 
insert into alumnos(nombre,apellidos,email,pais,nota) values('Roger','Cansaya','Rogercansayao@gmail.com','Peru',20);

select * from alumnos
where pais = 'Peru';

update alumnos
set id = 1001
where email = 'Rogercansayao@gmail.com';

insert into alumnos(nombre,apellidos,email,pais,nota) values('Roger','Cansaya','Rogercansayao@gmail.com','Peru',20);

insert into alumnos(id,nombre,apellidos,email,pais,nota) 
values
(1002,'Pepe','Soto','pepesoto@gmail.com','Peru',15);

delete from alumnos
where id = 1002;
